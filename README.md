# PredictStock

โปรเจคนี้เป็นการพยากรณ์ราคาหุ้นของ KBANK โดยใช้ข้อมูลจากคอลัมน์ราคาปิด (Closing Price) และโมเดล **GRU (Gated Recurrent Unit)** ซึ่งเป็นโมเดลที่เหมาะสมกับข้อมูลซีรี่ส์เวลา (Time Series Data) โดยเฉพาะอย่างยิ่งในกรณีที่ต้องการประมวลผลข้อมูลที่มีการเปลี่ยนแปลงอย่างรวดเร็วและไม่ต้องการใช้ทรัพยากรมาก

เหตุผลที่เลือกใช้ **GRU** แทนที่จะเป็น **LSTM** (Long Short-Term Memory) เนื่องจาก **GRU** มีโครงสร้างที่เรียบง่ายกว่า **LSTM** และใช้พารามิเตอร์น้อยกว่า ทำให้สามารถฝึกโมเดลได้เร็วขึ้น และยังสามารถจับลักษณะของข้อมูลในระยะยาวได้ดีในหลายๆ กรณี โดยไม่จำเป็นต้องคำนึงถึงความซับซ้อนในการใช้งานมากเกินไป


## Evaluation

ในการประเมินประสิทธิภาพของโมเดล เราได้ใช้สองตัวชี้วัดหลักคือ R² score และ RMSE​ :

**R² score หรือ Coefficient of Determination** 

- ใช้เพื่อวัดว่าโมเดลสามารถอธิบายความแปรปรวนของข้อมูลได้มากน้อยแค่ไหน ค่าของ R² จะอยู่ระหว่าง 0 ถึง 1 
- โดยที่ 1 หมายถึงโมเดลสามารถทำนายข้อมูลได้อย่างสมบูรณ์แบบ 
- ส่วน 0 หมายถึงโมเดลไม่สามารถอธิบายความแปรปรวนของข้อมูลได้เลย 
- ค่าที่ดีควรมี R² score ใกล้เคียงกับ 1 ซึ่งบ่งชี้ว่าโมเดลสามารถจับความสัมพันธ์ในข้อมูลได้ดี

**RMSE**
- ใช้เพื่อวัดความแตกต่างระหว่างค่าที่ทำนายได้และค่าจริงในหน่วยเดียวกับข้อมูล
- ค่าของ RMSE ที่ **ต่ำ** แสดงว่าโมเดลทำการทำนายได้แม่นยำมากขึ้น โดยทั่วไปแล้ว RMSE ที่ต่ำที่สุดจะดีที่สุด
- โมเดลที่มี RMSE ต่ำ จะสามารถทำนายผลลัพธ์ได้ใกล้เคียงกับข้อมูลจริงมากขึ้น

 <hr>
 
ทำการปรับ step (จำนวนวันที่ใช้ในการฝึกโมเดล) เพื่อหาค่าที่เหมาะสมที่สุดสำหรับการพยากรณ์ราคาหุ้น 
โดยการทดลองใช้ step ขนาดต่าง ๆ 

ดังตารางด้านล่าง เพื่อตรวจสอบว่าโมเดลทำงานได้ดีที่สุดกับข้อมูลในระยะเวลาสั้นหรือยาว

<img width="995" alt="eval" src="https://github.com/user-attachments/assets/67455851-02ab-4843-b35e-106228750f54" />



จากตาราง จะเห็นว่า STEP = 65 วัน พอเหมาะสำหรับการย้อนข้อมูลวัน 
ซึ่งให้ค่า R² score = 0.952 (สูง) และ RMSE = 2.526 (ต่ำ) 


<hr>

<img width="692" alt="step65" src="https://github.com/user-attachments/assets/a4c28728-ed4d-4819-9f42-043c307cd989" />

จากกราฟ แสดงการ เปรียบเทียบ ข้อมูลจริง(เส้นสีฟ้า) และข้อมูลที่ได้จากการทำนาย (เส้นสีแดง) ค่อนข้างใกล้เคียงกัน





